✔  checking if this is a source package ...
✔  checking if there is a namespace
✔  checking for executable files (1.1s)
✔  checking for hidden files and directories ...
✔  checking for portable file names
─  checking whether package 'hSSALT' can be installed ... [21s] WARNING (21.4s)
   Found the following significant warnings:
     EM_arma_int_cont.cpp:310:1: warning: control reaches end of non-void function [-Wreturn-type]
   See 'C:/Users/avner/AppData/Local/Temp/Rtmp8g7rYS/file8743bbe66b8/hSSALT.Rcheck/00install.out' for details.
─  used C++ compiler: 'G__~1.EXE (GCC) 12.3.0'
✔  checking installed package size ... 
✔  checking package directory
✔  checking for future file timestamps (995ms)
W  checking DESCRIPTION meta-information (466ms)
   Non-standard license specification:
     What license is it under?
   Standardizable: FALSE
   'LinkingTo' for 'parallel' is unused as it has no 'include' directory
N  checking top-level files
   Non-standard files/directories found at top level:
     'Testing' 'hSSALT.pdf' 'hSSALT_Rpackage.pdf'
✔  checking for left-over files
✔  checking index information
✔  checking package subdirectories ... 
✔  checking R files for non-ASCII characters ... 
✔  checking R files for syntax errors ... 
✔  checking whether the package can be loaded ... 
✔  checking whether the package can be loaded with stated dependencies ... 
✔  checking whether the package can be unloaded cleanly (340ms)
✔  checking whether the namespace can be loaded with stated dependencies (334ms)
✔  checking whether the namespace can be unloaded cleanly ... 
✔  checking loading without being on the library search path (402ms)
N  checking dependencies in R code (1.5s)
   Namespaces in Imports field not imported from:
     'BH' 'RcppArmadillo'
     All declared Imports should be used.
✔  checking S3 generic/method consistency (419ms)
✔  checking replacement functions (341ms)
✔  checking foreign function calls (445ms)
N  checking R code for possible problems (7s)
   CIbca_hSSALT: no visible global function definition for 'qnorm'
   CIbca_hSSALT: no visible global function definition for 'uniroot'
   CIbca_hSSALT: no visible global function definition for 'pnorm'
   CIbs_hSSALT: no visible global function definition for 'quantile'
   CIsay_hSSALT: no visible global function definition for 'qnorm'
   CIsay_hSSALT : bias: no visible global function definition for 'pbinom'
   EM_algorithm_censored: no visible global function definition for 'dexp'
   EM_algorithm_censored: no visible global function definition for 'pexp'
   EM_algorithm_interval: no visible global function definition for
     'dgeom'
   EM_algorithm_interval: no visible global function definition for
     'pgeom'
   HomohSSALT: no visible global function definition for 'rexp'
   HomohSSALT: no visible global function definition for 'quantile'
   MLE_Geo: no visible global function definition for 'uniroot'
   Secondderivative_O11: no visible binding for global variable 'n'
   bootstrap_distribution: no visible binding for global variable
     'na.omit'
   loglik_i_cont: no visible binding for global variable 'sample_dat_2nd'
   loglik_i_cont: no visible binding for global variable 'tau'
   loglik_i_cont: no visible binding for global variable 'n'
   loglik_i_cont: no visible binding for global variable 'n_f'
   loglik_i_interval: no visible binding for global variable 'tau2j0'
   loglik_i_interval: no visible binding for global variable 'tau'
   loglik_i_interval: no visible binding for global variable 'tau2j'
   loglik_i_interval: no visible binding for global variable 'n2j'
   loglik_i_interval: no visible binding for global variable 'n'
   loglik_i_interval: no visible binding for global variable 'nf'
   loglik_ii_cont: no visible binding for global variable 'sample_dat_2nd'
   loglik_ii_cont: no visible binding for global variable 'tau'
   loglik_ii_cont: no visible binding for global variable 'n'
   loglik_ii_cont: no visible binding for global variable 'r'
   rhSSALT: no visible global function definition for 'rexp'
   rhSSALT: no visible global function definition for 'rbinom'
   rhSSALT: no visible global function definition for 'runif'
   Undefined global functions or variables:
     dexp dgeom n n2j n_f na.omit nf pbinom pexp pgeom pnorm qnorm
     quantile r rbinom rexp runif sample_dat_2nd tau tau2j tau2j0 uniroot
   Consider adding
     importFrom("stats", "dexp", "dgeom", "na.omit", "pbinom", "pexp",
                "pgeom", "pnorm", "qnorm", "quantile", "rbinom", "rexp",
                "runif", "uniroot")
   to your NAMESPACE file.
   
   Found if() conditions comparing class() to string:
   File 'hSSALT/R/CIhSSALT.R': if (class(MLEhSSALT_Obj) != "hSSALTMLE") ...
   Use inherits() (or maybe is()) instead.
✔  checking Rd files ... 
✔  checking Rd metadata ... 
✔  checking Rd line widths ... 
✔  checking Rd cross-references ... 
✔  checking for missing documentation entries (336ms)
W  checking for code/documentation mismatches (451ms)
   Codoc mismatches from documentation object 'CIhSSALT':
   CIhSSALT
     Code: function(data, n, MLEhSSALT_Obj, censoring = 1, tau, r = NULL,
                    monitoring = "continuous", delta = NULL, CImethod =
                    "asymptotic", alpha = 0.05, B = 1000, maxit = 1000,
                    tol = 1e-08, language = "CPP", parallel = FALSE,
                    ncores = 2, grid = FALSE)
     Docs: function(data, n, MLEhSSALT_Obj, censoring = 1, tau, r = NULL,
                    monitoring = "continuous", delta = NULL, CImethod =
                    "asymptotic", alpha = 0.05, B = 1000, maxit = 1000,
                    tol = 1e-08, language = "CPP", parallel = FALSE,
                    ncores = 2)
     Argument names in code not in docs:
       grid
   
✔  checking Rd \usage sections (1.3s)
✔  checking Rd contents ... 
✔  checking for unstated dependencies in examples ... 
✔  checking contents of 'data' directory ...
✔  checking data for non-ASCII characters ... 
✔  checking LazyData ...
✔  checking data for ASCII and uncompressed saves ... 
✔  checking line endings in C/C++/Fortran sources/headers ...
✔  checking pragmas in C/C++ headers and code
✔  checking compilation flags used
✔  checking compiled code (13.1s)
✔  checking examples (5.6s)
✔  checking for non-standard things in the check directory
✔  checking for detritus in the temp directory
   
   See
     'C:/Users/avner/AppData/Local/Temp/Rtmp8g7rYS/file8743bbe66b8/hSSALT.Rcheck/00check.log'
   for details.
   
   
   ERROR: Unknown command "TMPDIR=C:/Users/avner/AppData/Local/Temp/RtmpAFglXY/fileda6c313ff70". Did you mean command "create-project"?
   
   Error: Unknown command "TMPDIR=C:/Users/avner/AppData/Local/Temp/RtmpAFglXY/fileda6c313ff70". Did you mean command "create-project"?
       at Command.parseArguments (file:///C:/PROGRA~1/RStudio/RESOUR~1/app/bin/quarto/bin/quarto.js:8553:31)
       at Command.parseCommand (file:///C:/PROGRA~1/RStudio/RESOUR~1/app/bin/quarto/bin/quarto.js:8320:31)
       at async quarto (file:///C:/PROGRA~1/RStudio/RESOUR~1/app/bin/quarto/bin/quarto.js:127542:5)
       at async file:///C:/PROGRA~1/RStudio/RESOUR~1/app/bin/quarto/bin/quarto.js:127560:9
   Warning message:
   In system2("quarto", "-V", stdout = TRUE, env = paste0("TMPDIR=",  :
     running command '"quarto" TMPDIR=C:/Users/avner/AppData/Local/Temp/RtmpAFglXY/fileda6c313ff70 -V' had status 1
── R CMD check results ──────────────────────────────────────────────────────────────────────────────────────────────────────────── hSSALT 0.1.0 ────
Duration: 1m 3.5s

❯ checking whether package 'hSSALT' can be installed ... [21s] WARNING
  See below...

❯ checking DESCRIPTION meta-information ... WARNING
  Non-standard license specification:
    What license is it under?
  Standardizable: FALSE
  'LinkingTo' for 'parallel' is unused as it has no 'include' directory

❯ checking for code/documentation mismatches ... WARNING
  Codoc mismatches from documentation object 'CIhSSALT':
  CIhSSALT
    Code: function(data, n, MLEhSSALT_Obj, censoring = 1, tau, r = NULL,
                   monitoring = "continuous", delta = NULL, CImethod =
                   "asymptotic", alpha = 0.05, B = 1000, maxit = 1000,
                   tol = 1e-08, language = "CPP", parallel = FALSE,
                   ncores = 2, grid = FALSE)
    Docs: function(data, n, MLEhSSALT_Obj, censoring = 1, tau, r = NULL,
                   monitoring = "continuous", delta = NULL, CImethod =
                   "asymptotic", alpha = 0.05, B = 1000, maxit = 1000,
                   tol = 1e-08, language = "CPP", parallel = FALSE,
                   ncores = 2)
    Argument names in code not in docs:
      grid

❯ checking top-level files ... NOTE
  Non-standard files/directories found at top level:
    'Testing' 'hSSALT.pdf' 'hSSALT_Rpackage.pdf'

❯ checking dependencies in R code ... NOTE
  Namespaces in Imports field not imported from:
    'BH' 'RcppArmadillo'
    All declared Imports should be used.

❯ checking R code for possible problems ... NOTE
  CIbca_hSSALT: no visible global function definition for 'qnorm'
  CIbca_hSSALT: no visible global function definition for 'uniroot'
  CIbca_hSSALT: no visible global function definition for 'pnorm'
  CIbs_hSSALT: no visible global function definition for 'quantile'
  CIsay_hSSALT: no visible global function definition for 'qnorm'
  CIsay_hSSALT : bias: no visible global function definition for 'pbinom'
  EM_algorithm_censored: no visible global function definition for 'dexp'
  EM_algorithm_censored: no visible global function definition for 'pexp'
  EM_algorithm_interval: no visible global function definition for
    'dgeom'
  EM_algorithm_interval: no visible global function definition for
    'pgeom'
  HomohSSALT: no visible global function definition for 'rexp'
  HomohSSALT: no visible global function definition for 'quantile'
  MLE_Geo: no visible global function definition for 'uniroot'
  Secondderivative_O11: no visible binding for global variable 'n'
  bootstrap_distribution: no visible binding for global variable
    'na.omit'
  loglik_i_cont: no visible binding for global variable 'sample_dat_2nd'
  loglik_i_cont: no visible binding for global variable 'tau'
  loglik_i_cont: no visible binding for global variable 'n'
  loglik_i_cont: no visible binding for global variable 'n_f'
  loglik_i_interval: no visible binding for global variable 'tau2j0'
  loglik_i_interval: no visible binding for global variable 'tau'
  loglik_i_interval: no visible binding for global variable 'tau2j'
  loglik_i_interval: no visible binding for global variable 'n2j'
  loglik_i_interval: no visible binding for global variable 'n'
  loglik_i_interval: no visible binding for global variable 'nf'
  loglik_ii_cont: no visible binding for global variable 'sample_dat_2nd'
  loglik_ii_cont: no visible binding for global variable 'tau'
  loglik_ii_cont: no visible binding for global variable 'n'
  loglik_ii_cont: no visible binding for global variable 'r'
  rhSSALT: no visible global function definition for 'rexp'
  rhSSALT: no visible global function definition for 'rbinom'
  rhSSALT: no visible global function definition for 'runif'
  Undefined global functions or variables:
    dexp dgeom n n2j n_f na.omit nf pbinom pexp pgeom pnorm qnorm
    quantile r rbinom rexp runif sample_dat_2nd tau tau2j tau2j0 uniroot
  Consider adding
    importFrom("stats", "dexp", "dgeom", "na.omit", "pbinom", "pexp",
               "pgeom", "pnorm", "qnorm", "quantile", "rbinom", "rexp",
               "runif", "uniroot")
  to your NAMESPACE file.
  
  Found if() conditions comparing class() to string:
  File 'hSSALT/R/CIhSSALT.R': if (class(MLEhSSALT_Obj) != "hSSALTMLE") ...
  Use inherits() (or maybe is()) instead.

0 errors ✔ | 3 warnings ✖ | 3 notes ✖
> 
> 
> library(hSSALT)
> 
> ############Variables
> n <- 40
> tau <- c(8,16)
> theta1 <- 33.12
> theta21 <- 2
> theta22 <- 15
> p <- 0.4
> B <- 500
> r <- 30
> delta <- 0.5
> seed <- 1:4
> 
> ############Continuous Type-I case
> results.cont.asymptotic <- list()
> results.cont.percentile <- list()
> results.cont.bca <- list()
> 
> MLE_NotNA.cont <- rep(0, length(seed))
> MLE_converge.cont <- rep(0, length(seed))
> MLE_heter.cont <- rep(0, length(seed))
> 
> for (i in seed) {
+   set.seed(i)
+   sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+   resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="continuous")
+   
+   # Test the Sample
+   if (!is.na(resMLE$info)) {
+     MLE_NotNA.cont[i] <- TRUE
+     MLE_heter.cont[i] <- ifelse(resMLE$info == "heterogeneous", TRUE, FALSE)
+     MLE_converge.cont[i] <- ifelse(resMLE$message == "convergent", TRUE, FALSE)
+   } else {
+     MLE_NotNA.cont[i] <- FALSE
+     MLE_converge.cont[i] <- FALSE
+     MLE_heter.cont[i] <- FALSE
+     
+   }
+   
+   if (is.na(resMLE$info)  || resMLE$info != "heterogeneous" || resMLE$message != "convergent") {
+     results.cont.asymptotic[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.cont.percentile[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.cont.bca[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+   } else {
+     
+     ### Results
+     #Asymptotic
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="continuous")
+     
+     results.cont.asymptotic[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "R",monitoring = "continuous", B=B,grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #Percentile
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="continuous")
+     
+     results.cont.percentile[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "R",monitoring = "continuous", B=B,CImethod="percentile",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #BCa
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="continuous")
+     
+     results.cont.bca[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "R",monitoring = "continuous", B=B,CImethod="bca",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+   }
+   cat("i: ", i, "\n")
+ }
i:  1 
i:  2 
i:  3 
i:  4 
Warning messages:
1: In EM_algorithm_censored(ind = 1, data = t22 - tau[1], d = d, N = maxit,  :
  The EM Algorithm failed to converge!
2: In EM_algorithm_censored(ind = 1, data = t22 - tau[1], d = d, N = maxit,  :
  The EM Algorithm failed to converge!
3: In MLE_Exp(data = data, n = n, censoring, tau = tau, r, theta21 = theta21,  :
  Mean lifetime in first stress level must be greater than mean lifetimes in the second stress level.
> 
> ### End Results
> 
> #Asymptotic
> df.cont.asymptotic.temp <- do.call(rbind, lapply(results.cont.asymptotic, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.cont.asymptotic.R <- cbind(seed, df.cont.asymptotic.temp, MLE_NotNA.cont, MLE_converge.cont, MLE_heter.cont)
> df.cont.asymptotic.R
  seed theta1_l theta1_u theta21_l theta21_u theta22_l theta22_u p_l       p_u  B  j alpha       type MLE_NotNA.cont MLE_converge.cont
1    1 0.000000  0.00000         0  0.000000         0   0.00000   0 0.0000000  0  0  0.00          0              1                 0
2    2 3.128428 64.94836         0  4.920912         0  24.70393   0 0.7375117 NA NA  0.05 Asymptotic              1                 1
3    3 0.000000  0.00000         0  0.000000         0   0.00000   0 0.0000000  0  0  0.00          0              1                 0
4    4 0.000000  0.00000         0  0.000000         0   0.00000   0 0.0000000  0  0  0.00          0              0                 0
  MLE_heter.cont
1              1
2              1
3              1
4              0
> 
> # Percentile
> df.cont.percentile.temp <- do.call(rbind, lapply(results.cont.percentile, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.cont.percentile.R <- cbind(seed, df.cont.percentile.temp, MLE_NotNA.cont, MLE_converge.cont, MLE_heter.cont)
> df.cont.percentile.R
  seed theta1_l theta1_u  theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B    j alpha       type MLE_NotNA.cont MLE_converge.cont
1    1  0.00000    0.000 0.00000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00          0              1                 0
2    2 22.62828  153.149 0.09747831  2.187812  6.666493  28.84548 0.05036309 0.4867546 500 1081  0.05 Percentile              1                 1
3    3  0.00000    0.000 0.00000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00          0              1                 0
4    4  0.00000    0.000 0.00000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00          0              0                 0
  MLE_heter.cont
1              1
2              1
3              1
4              0
> 
> # BCa
> df.cont.bca.temp <- do.call(rbind, lapply(results.cont.bca, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.cont.bca.R <- cbind(seed, df.cont.bca.temp, MLE_NotNA.cont, MLE_converge.cont, MLE_heter.cont)
> df.cont.bca.R
  seed theta1_l theta1_u   theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B    j alpha type MLE_NotNA.cont MLE_converge.cont
1    1  0.00000    0.000 0.000000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00    0              1                 0
2    2 19.66853  102.225 0.005199422  3.782245  3.937585  29.12217 0.02667326 0.5386767 500 1081  0.05  BCa              1                 1
3    3  0.00000    0.000 0.000000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00    0              1                 0
4    4  0.00000    0.000 0.000000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00    0              0                 0
  MLE_heter.cont
1              1
2              1
3              1
4              0
> 
> # ############Continuous Type-II case
> # results <- list()
> # m <- 1
> # 
> # for (i in 1:100) {
> #   set.seed(i)
> #   sample <- rhSSALT(n,2,r=r,tau=tau[1],theta1=theta1,theta21 = theta21,theta22 = theta22,p=p)
> #   resMLE <- MLEhSSALT(sample$Censored_dat,n,2,r=r,tau=tau[1],theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="continuous")
> #   
> #   if (!is.na(resMLE$info)) {
> #     if (resMLE$info == "heterogeneous" && resMLE$message == "convergent") {
> #       cat("i: ", i, "\n")
> #       res <- CIhSSALT(sample$Censored_dat,n,1,tau=c(8,16),MLEhSSALT_Obj=resMLE,language = "R", CImethod="bca", B=B,grid=F) #Modify for Type-II
> #       results[[m]] <- res
> #       m <- m+1
> #     }
> #   }
> # }
> 
> 
> ############Interval case
> results.int.asymptotic <- list()
> results.int.percentile <- list()
> results.int.bca <- list()
> 
> MLE_NotNA.int <- rep(0, length(seed))
> MLE_converge.int <- rep(0, length(seed))
> MLE_heter.int <- rep(0, length(seed))
> 
> for (i in seed) {
+   set.seed(i)
+   sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+   resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="interval", delta=delta)
+   
+   # Test the Sample
+   if (!is.na(resMLE$info)) {
+     MLE_NotNA.int[i] <- TRUE
+     MLE_heter.int[i] <- ifelse(resMLE$info == "heterogeneous", TRUE, FALSE)
+     MLE_converge.int[i] <- ifelse(resMLE$message == "convergent", TRUE, FALSE)
+   } else {
+     MLE_NotNA.int[i] <- FALSE
+     MLE_converge.int[i] <- FALSE
+     MLE_heter.int[i] <- FALSE
+     
+   }
+   
+   if (is.na(resMLE$info)  || resMLE$info != "heterogeneous" || resMLE$message != "convergent") {
+     results.int.asymptotic[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.int.percentile[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.int.bca[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+   } else {
+     
+     ### Results
+     #Asymptotic
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="interval", delta=delta)
+     
+     results.int.asymptotic[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "R",monitoring = "interval",delta=delta, B=B,grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #Percentile
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="interval", delta=delta)
+     
+     results.int.percentile[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "R",monitoring = "interval",delta=delta, B=B,CImethod="percentile",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #BCa
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="interval", delta=delta)
+     
+     results.int.bca[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "R",monitoring = "interval",delta=delta, B=B,CImethod="bca",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+   }
+   cat("i: ", i, "\n")
+ }
i:  1 
i:  2 
i:  3 
i:  4 
Warning messages:
1: In EM_algorithm_interval(ind = 1, data = data_starts, N = maxit,  :
  The EM Algorithm failed to converge!
2: In EM_algorithm_interval(ind = 1, data = data_starts, N = maxit,  :
  The EM Algorithm failed to converge!
3: In MLE_Geo(data = data, n = n, tau = tau, delta = delta, theta21 = theta21,  :
  Mean lifetime in first stress level must be greater than mean lifetimes in the second stress level.
> 
> ### End Results
> 
> #Asymptotic
> df.int.asymptotic.temp <- do.call(rbind, lapply(results.int.asymptotic, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.int.asymptotic.R <- cbind(seed, df.int.asymptotic.temp, MLE_NotNA.int, MLE_converge.int, MLE_heter.int)
> df.int.asymptotic.R
  seed theta1_l theta1_u theta21_l theta21_u theta22_l theta22_u p_l       p_u  B  j alpha       type MLE_NotNA.int MLE_converge.int MLE_heter.int
1    1  0.00000  0.00000         0  0.000000 0.0000000   0.00000   0 0.0000000  0  0  0.00          0             1                0             1
2    2 10.80290 72.55326         0  4.127068 0.3471419  22.47635   0 0.6412203 NA NA  0.05 Asymptotic             1                1             1
3    3 10.79731 46.00125         0 57.176533 3.7272891  10.89201   0 0.2535691 NA NA  0.05 Asymptotic             1                1             1
4    4  0.00000  0.00000         0  0.000000 0.0000000   0.00000   0 0.0000000  0  0  0.00          0             0                0             0
> 
> # Percentile
> df.int.percentile.temp <- do.call(rbind, lapply(results.int.percentile, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.int.percentile.R <- cbind(seed, df.int.percentile.temp, MLE_NotNA.int, MLE_converge.int, MLE_heter.int)
> df.int.percentile.R
  seed theta1_l  theta1_u theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B   j alpha       type MLE_NotNA.int MLE_converge.int
1    1  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00          0             1                0
2    2 23.13794 130.02900         0  2.602970  6.464242  29.73892 0.03488820 0.4969245 500 749  0.05 Percentile             1                1
3    3 17.19365  60.60216         0  1.342305  4.768288  15.25407 0.02500632 0.4141374 500 558  0.05 Percentile             1                1
4    4  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00          0             0                0
  MLE_heter.int
1             1
2             1
3             1
4             0
> 
> # BCa
> df.int.bca.temp <- do.call(rbind, lapply(results.int.bca, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.int.bca.R <- cbind(seed, df.int.bca.temp, MLE_NotNA.int, MLE_converge.int, MLE_heter.int)
> df.int.bca.R
  seed theta1_l  theta1_u theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B   j alpha type MLE_NotNA.int MLE_converge.int
1    1  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00    0             1                0
2    2 19.10607 102.24980         0  2.917989  3.949272  29.73295 0.01147170 0.5175320 500 749  0.05  BCa             1                1
3    3 12.88730  60.54966         0  1.387184  3.794511  13.69848 0.01094527 0.3058612 500 558  0.05  BCa             1                1
4    4  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00    0             0                0
  MLE_heter.int
1             1
2             1
3             1
4             0
> 
> #save.image(file="testing_400_R.Rdata")
> 
> 
> 
> ###C++
> 
> 
> ############Continuous Type-I case
> results.cont.asymptotic <- list()
> results.cont.percentile <- list()
> results.cont.bca <- list()
> 
> MLE_NotNA.cont <- rep(0, length(seed))
> MLE_converge.cont <- rep(0, length(seed))
> MLE_heter.cont <- rep(0, length(seed))
> 
> for (i in seed) {
+   set.seed(i)
+   sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+   resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="continuous")
+   
+   # Test the Sample
+   if (!is.na(resMLE$info)) {
+     MLE_NotNA.cont[i] <- TRUE
+     MLE_heter.cont[i] <- ifelse(resMLE$info == "heterogeneous", TRUE, FALSE)
+     MLE_converge.cont[i] <- ifelse(resMLE$message == "convergent", TRUE, FALSE)
+   } else {
+     MLE_NotNA.cont[i] <- FALSE
+     MLE_converge.cont[i] <- FALSE
+     MLE_heter.cont[i] <- FALSE
+     
+   }
+   
+   if (is.na(resMLE$info)  || resMLE$info != "heterogeneous" || resMLE$message != "convergent") {
+     results.cont.asymptotic[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.cont.percentile[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.cont.bca[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+   } else {
+     
+     ### Results
+     #Asymptotic
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="continuous")
+     
+     results.cont.asymptotic[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "CPP",monitoring = "continuous", B=B,grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #Percentile
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="continuous")
+     
+     results.cont.percentile[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "CPP",monitoring = "continuous", B=B,CImethod="percentile",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #BCa
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="continuous")
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="continuous")
+     
+     results.cont.bca[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "CPP",monitoring = "continuous", B=B,CImethod="bca",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+   }
+   cat("i: ", i, "\n")
+ }
i:  1 
i:  2 
i:  3 
i:  4 
Warning message:
In MLE_Exp(data = data, n = n, censoring, tau = tau, r, theta21 = theta21,  :
  Mean lifetime in first stress level must be greater than mean lifetimes in the second stress level.
> 
> ### End Results
> 
> #Asymptotic
> df.cont.asymptotic.temp <- do.call(rbind, lapply(results.cont.asymptotic, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.cont.asymptotic.cpp <- cbind(seed, df.cont.asymptotic.temp, MLE_NotNA.cont, MLE_converge.cont, MLE_heter.cont)
> df.cont.asymptotic.cpp
  seed theta1_l theta1_u theta21_l theta21_u theta22_l theta22_u p_l       p_u  B  j alpha       type MLE_NotNA.cont MLE_converge.cont
1    1 0.000000  0.00000         0  0.000000         0   0.00000   0 0.0000000  0  0  0.00          0              1                 0
2    2 3.128428 64.94836         0  4.920912         0  24.70393   0 0.7375117 NA NA  0.05 Asymptotic              1                 1
3    3 0.000000  0.00000         0  0.000000         0   0.00000   0 0.0000000  0  0  0.00          0              1                 0
4    4 0.000000  0.00000         0  0.000000         0   0.00000   0 0.0000000  0  0  0.00          0              0                 0
  MLE_heter.cont
1              1
2              1
3              1
4              0
> 
> # Percentile
> df.cont.percentile.temp <- do.call(rbind, lapply(results.cont.percentile, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.cont.percentile.cpp <- cbind(seed, df.cont.percentile.temp, MLE_NotNA.cont, MLE_converge.cont, MLE_heter.cont)
> df.cont.percentile.cpp
  seed theta1_l theta1_u  theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B    j alpha       type MLE_NotNA.cont MLE_converge.cont
1    1  0.00000    0.000 0.00000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00          0              1                 0
2    2 22.62828  153.149 0.09747831  2.187812  6.666493  28.84548 0.05036309 0.4867546 500 1081  0.05 Percentile              1                 1
3    3  0.00000    0.000 0.00000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00          0              1                 0
4    4  0.00000    0.000 0.00000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00          0              0                 0
  MLE_heter.cont
1              1
2              1
3              1
4              0
> 
> # BCa
> df.cont.bca.temp <- do.call(rbind, lapply(results.cont.bca, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.cont.bca.cpp <- cbind(seed, df.cont.bca.temp, MLE_NotNA.cont, MLE_converge.cont, MLE_heter.cont)
> df.cont.bca.cpp
  seed theta1_l theta1_u   theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B    j alpha type MLE_NotNA.cont MLE_converge.cont
1    1  0.00000    0.000 0.000000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00    0              1                 0
2    2 19.66853  102.225 0.005199422  3.782245  3.937585  29.12217 0.02667326 0.5386767 500 1081  0.05  BCa              1                 1
3    3  0.00000    0.000 0.000000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00    0              1                 0
4    4  0.00000    0.000 0.000000000  0.000000  0.000000   0.00000 0.00000000 0.0000000   0    0  0.00    0              0                 0
  MLE_heter.cont
1              1
2              1
3              1
4              0
> 
> # ############Continuous Type-II case
> # results <- list()
> # m <- 1
> # 
> # for (i in 1:100) {
> #   set.seed(i)
> #   sample <- rhSSALT(n,2,r=r,tau=tau[1],theta1=theta1,theta21 = theta21,theta22 = theta22,p=p)
> #   resMLE <- MLEhSSALT(sample$Censored_dat,n,2,r=r,tau=tau[1],theta21 = theta21,theta22 = theta22,p=p,language = "R", monitoring="continuous")
> #   
> #   if (!is.na(resMLE$info)) {
> #     if (resMLE$info == "heterogeneous" && resMLE$message == "convergent") {
> #       cat("i: ", i, "\n")
> #       res <- CIhSSALT(sample$Censored_dat,n,1,tau=c(8,16),MLEhSSALT_Obj=resMLE,language = "R", CImethod="bca", B=B,grid=F) #Modify for Type-II
> #       results[[m]] <- res
> #       m <- m+1
> #     }
> #   }
> # }
> 
> 
> ############Interval case
> results.int.asymptotic <- list()
> results.int.percentile <- list()
> results.int.bca <- list()
> 
> MLE_NotNA.int <- rep(0, length(seed))
> MLE_converge.int <- rep(0, length(seed))
> MLE_heter.int <- rep(0, length(seed))
> 
> for (i in seed) {
+   set.seed(i)
+   sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+   resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="interval", delta=delta)
+   
+   # Test the Sample
+   if (!is.na(resMLE$info)) {
+     MLE_NotNA.int[i] <- TRUE
+     MLE_heter.int[i] <- ifelse(resMLE$info == "heterogeneous", TRUE, FALSE)
+     MLE_converge.int[i] <- ifelse(resMLE$message == "convergent", TRUE, FALSE)
+   } else {
+     MLE_NotNA.int[i] <- FALSE
+     MLE_converge.int[i] <- FALSE
+     MLE_heter.int[i] <- FALSE
+     
+   }
+   
+   if (is.na(resMLE$info)  || resMLE$info != "heterogeneous" || resMLE$message != "convergent") {
+     results.int.asymptotic[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.int.percentile[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+     results.int.bca[[i]] <- list(theta1=c(0,0), theta21=c(0,0), theta22=c(0,0),p=c(0,0), B=0, j=0, alpha=0, type=0)
+   } else {
+     
+     ### Results
+     #Asymptotic
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="interval", delta=delta)
+     
+     results.int.asymptotic[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "CPP",monitoring = "interval",delta=delta, B=B,grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #Percentile
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="interval", delta=delta)
+     
+     results.int.percentile[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "CPP",monitoring = "interval",delta=delta, B=B,CImethod="percentile",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+     #BCa
+     
+     set.seed(i)
+     sample <- rhSSALT(n,1,tau=tau,theta1=theta1,theta21 = theta21,theta22 = theta22,p=p, monitoring="interval",delta=delta)
+     resMLE <- MLEhSSALT(sample$Censored_dat,n,1,tau=tau,theta21 = theta21,theta22 = theta22,p=p,language = "CPP", monitoring="interval", delta=delta)
+     
+     results.int.bca[[i]] <- tryCatch(
+       {
+         CIhSSALT(sample$Censored_dat,n,1,tau=tau,MLEhSSALT_Obj=resMLE,language = "CPP",monitoring = "interval",delta=delta, B=B,CImethod="bca",grid=F)
+       },
+       error = function(e) {
+         list(theta1=c(NA,NA), theta21=c(NA,NA), theta22=c(NA,NA),p=c(NA,NA), B=NA, j=NA, alpha=NA, type=NA)
+       }
+     )
+   }
+   cat("i: ", i, "\n")
+ }
i:  1 
i:  2 
i:  3 
i:  4 
Warning message:
In MLE_Geo(data = data, n = n, tau = tau, delta = delta, theta21 = theta21,  :
  Mean lifetime in first stress level must be greater than mean lifetimes in the second stress level.
> 
> ### End Results
> 
> #Asymptotic
> df.int.asymptotic.temp <- do.call(rbind, lapply(results.int.asymptotic, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.int.asymptotic.cpp <- cbind(seed, df.int.asymptotic.temp, MLE_NotNA.int, MLE_converge.int, MLE_heter.int)
> df.int.asymptotic.cpp
  seed theta1_l theta1_u theta21_l theta21_u theta22_l theta22_u p_l       p_u  B  j alpha       type MLE_NotNA.int MLE_converge.int MLE_heter.int
1    1  0.00000  0.00000         0  0.000000 0.0000000   0.00000   0 0.0000000  0  0  0.00          0             1                0             1
2    2 10.80290 72.55326         0  4.127068 0.3471419  22.47635   0 0.6412203 NA NA  0.05 Asymptotic             1                1             1
3    3 10.79731 46.00125         0 57.181813 3.7272891  10.89201   0 0.2535691 NA NA  0.05 Asymptotic             1                1             1
4    4  0.00000  0.00000         0  0.000000 0.0000000   0.00000   0 0.0000000  0  0  0.00          0             0                0             0
> 
> # Percentile
> df.int.percentile.temp <- do.call(rbind, lapply(results.int.percentile, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.int.percentile.cpp <- cbind(seed, df.int.percentile.temp, MLE_NotNA.int, MLE_converge.int, MLE_heter.int)
> df.int.percentile.cpp
  seed theta1_l  theta1_u theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B   j alpha       type MLE_NotNA.int MLE_converge.int
1    1  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00          0             1                0
2    2 23.13794 130.02900         0  2.602970  6.464242  29.73892 0.03488820 0.4969245 500 749  0.05 Percentile             1                1
3    3 17.19365  60.60216         0  1.342305  4.768251  15.25407 0.02497218 0.4141374 500 558  0.05 Percentile             1                1
4    4  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00          0             0                0
  MLE_heter.int
1             1
2             1
3             1
4             0
> 
> # BCa
> df.int.bca.temp <- do.call(rbind, lapply(results.int.bca, function(x) {
+   data.frame(
+     theta1_l = x$theta1[1],
+     theta1_u = x$theta1[2],
+     theta21_l = x$theta21[1],
+     theta21_u = x$theta21[2],
+     theta22_l = x$theta22[1],
+     theta22_u = x$theta22[2],
+     p_l = x$p[1],
+     p_u = x$p[2],
+     B=x$B,
+     j=x$j,
+     alpha=x$alpha,
+     type=x$type
+   )
+ }))
> df.int.bca.cpp <- cbind(seed, df.int.bca.temp, MLE_NotNA.int, MLE_converge.int, MLE_heter.int)
> df.int.bca.cpp
  seed theta1_l  theta1_u theta21_l theta21_u theta22_l theta22_u        p_l       p_u   B   j alpha type MLE_NotNA.int MLE_converge.int
1    1  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00    0             1                0
2    2 19.10607 102.24980         0  2.917989  3.949272  29.73295 0.01147170 0.5175320 500 749  0.05  BCa             1                1
3    3 12.88730  60.54966         0  1.387184  3.794511  13.69848 0.01094527 0.3058612 500 558  0.05  BCa             1                1
4    4  0.00000   0.00000         0  0.000000  0.000000   0.00000 0.00000000 0.0000000   0   0  0.00    0             0                0
  MLE_heter.int
1             1
2             1
3             1
4             0
> 
> 
> #save.image(file="testing_library_cpp.Rdata")